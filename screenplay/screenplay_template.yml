---

  metadata:
    experimentname: APT32_template
    nodes_num: 1
    network_num: 1
    
  node:
    - name: attacker_and_victim
      properties: 
        platform: [ deter | openstack ]
        machine: [ physical | virtual ]
      os:
        platform: Windows
      service:
        - Apache2
        - Python3
      objects:
        #IOCS and Files(internal location / network loation)

        # upload directly
        - news.zip
        - flash_update.zip 

        # internal location 
		    - CVE/APT32/

        # network location
        - https://archive.apache.org/dist/httpd/binaries/win32/apache_2.2.4-win32-x86-no_ssl.msi
        
        
  network:
    lan:
      - name: lan1
        endpoints:
          - attacker_and_victim
  
  activity:
      # unit: s(econd), m(inute), h(our)
      # time delay: +N(unit)
      # sequential order: +1(no unit)
	  
    - timestamp: t + 0 + 0s
      description: Configure the webserver, install the services
      subject: attacker_and_victim
      object: attacker_and_victim
      event: 
        - install node[service]
        - run node[service][Apache2]
    
    - timestamp: t + 1 + 0s
      description: Open the malicious webpage article.html
      subject: attacker_and_victim
      object: article.html
      event: 
        - openwebpage object

    - timestamp: t + 1 + 15s
      description: Once the video player fails to load and the pop-up asks to update your flash player, 
	  Click the picture of the Adobe flash upgrade to trigger the download of flash_update.zip
      subject: attacker_and_victim
      object: flash_update.zip
      event: 
        - download object
		
  	- timestamp: t + 2 + 15s
      description: Decompress flash_update.zip to release the system.py
      subject: attacker_and_victim
      object: flash_update.zip
      event: 
        - unzip object
  	
  	- timestamp: t + 3 + 15s
      description: Run system.py via Python3 to generate dataexfil.txt
      subject: attacker_and_victim
      object: system.py
      event: 
        - python3 object
  		
  	- timestamp: t + 3 + 30s
      description: Open data.html to view the infiltrated data captured by the python file
      subject: attacker_and_victim
      object: data.html
      event: 
        - openwebpage object
        - printwebpage object
		 
  


